# Test info

- Name: Performance Testing >> Cart operations performance
- Location: D:\W123-project\tests\performance.spec.ts:68:3

# Error details

```
Error: page.waitForSelector: Test timeout of 30000ms exceeded.
Call log:
  - waiting for locator('[data-testid="product-card"]') to be visible

    at D:\W123-project\tests\performance.spec.ts:72:16
```

# Page snapshot

```yaml
- region "Notifications alt+T"
- banner:
  - button "Y Yapee"
  - textbox "T√¨m ki·∫øm s·∫£n ph·∫©m..."
  - img
  - button "T√¨m"
  - button "üåü Poster"
  - button:
    - img
  - button "ƒêƒÉng nh·∫≠p":
    - img
    - text: ƒêƒÉng nh·∫≠p
- main:
  - heading "üéâ Ch√†o m·ª´ng ƒë·∫øn ShopVN" [level=1]
  - paragraph: üõçÔ∏è Kh√°m ph√° h√†ng tri·ªáu s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao v·ªõi gi√° t·ªët nh·∫•t th·ªã tr∆∞·ªùng!
  - text: üöö Giao h√†ng nhanh Mi·ªÖn ph√≠ ship üíé Ch·∫•t l∆∞·ª£ng cao H√†ng ch√≠nh h√£ng üéÅ ∆Øu ƒë·∫°i kh·ªßng Gi·∫£m ƒë·∫øn 70%
  - button "üõí Mua ngay"
  - button "‚ú® Xem s·∫£n ph·∫©m n·ªïi b·∫≠t"
  - text: 1M+ Kh√°ch h√†ng 100K+ S·∫£n ph·∫©m 4.8‚≠ê ƒê√°nh gi√°
  - heading "üè∑Ô∏è Danh M·ª•c S·∫£n Ph·∫©m" [level=2]
  - paragraph: Kh√°m ph√° c√°c danh m·ª•c s·∫£n ph·∫©m ƒëa d·∫°ng
  - button "üì± ƒêi·ªán t·ª≠ Thi·∫øt b·ªã ƒëi·ªán t·ª≠, c√¥ng ngh·ªá":
    - text: üì±
    - heading "ƒêi·ªán t·ª≠" [level=3]
    - paragraph: Thi·∫øt b·ªã ƒëi·ªán t·ª≠, c√¥ng ngh·ªá
  - button "üëï Th·ªùi trang Qu·∫ßn √°o, ph·ª• ki·ªán th·ªùi trang":
    - text: üëï
    - heading "Th·ªùi trang" [level=3]
    - paragraph: Qu·∫ßn √°o, ph·ª• ki·ªán th·ªùi trang
  - button "üè† Gia d·ª•ng ƒê·ªì gia d·ª•ng, n·ªôi th·∫•t":
    - text: üè†
    - heading "Gia d·ª•ng" [level=3]
    - paragraph: ƒê·ªì gia d·ª•ng, n·ªôi th·∫•t
  - heading "üî• KHUY·∫æN M√ÉI HOT üî•" [level=3]
  - paragraph: Gi·∫£m gi√° l√™n ƒë·∫øn 70% cho t·∫•t c·∫£ danh m·ª•c!
  - button "Mua Ngay üõí"
  - text: üí• ‚ö° üéâ üéÅ ‚ö°
  - heading "Flash Sale" [level=2]
  - paragraph: Gi·∫£m gi√° s·ªëc trong th·ªùi gian c√≥ h·∫°n
  - text: "107 Gi·ªù : 41 Ph√∫t : 03 Gi√¢y"
  - img "iPhone 15 Pro Max"
  - text: "-9% ‚ö° FLASH"
  - button "Th√™m iPhone 15 Pro Max v√†o gi·ªè h√†ng":
    - img
  - heading "iPhone 15 Pro Max" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (156) 29.990.000ƒë 32.990.000ƒë
  - img "N·ªìi C∆°m ƒêi·ªán Cao C·∫•p"
  - text: "-17% ‚ö° FLASH"
  - button "Th√™m N·ªìi C∆°m ƒêi·ªán Cao C·∫•p v√†o gi·ªè h√†ng":
    - img
  - heading "N·ªìi C∆°m ƒêi·ªán Cao C·∫•p" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (67) 2.490.000ƒë 2.990.000ƒë
  - img "Tai Nghe Bluetooth Premium"
  - text: "-20% ‚ö° FLASH"
  - button "Th√™m Tai Nghe Bluetooth Premium v√†o gi·ªè h√†ng":
    - img
  - heading "Tai Nghe Bluetooth Premium" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (123) 1.990.000ƒë 2.490.000ƒë
  - button "Xem t·∫•t c·∫£":
    - text: Xem t·∫•t c·∫£
    - img
  - heading "S·∫£n ph·∫©m n·ªïi b·∫≠t" [level=2]
  - paragraph: Nh·ªØng s·∫£n ph·∫©m ƒë∆∞·ª£c y√™u th√≠ch nh·∫•t
  - img "MacBook Air M3"
  - text: "-7%"
  - button "Th√™m MacBook Air M3 v√†o gi·ªè h√†ng":
    - img
  - heading "MacBook Air M3" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (89) 27.990.000ƒë 29.990.000ƒë
  - 'img "S√°ch: ƒê·∫Øc Nh√¢n T√¢m"'
  - text: "-26%"
  - 'button "Th√™m S√°ch: ƒê·∫Øc Nh√¢n T√¢m v√†o gi·ªè h√†ng"':
    - img
  - 'heading "S√°ch: ƒê·∫Øc Nh√¢n T√¢m" [level=3]'
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (567) 89.000ƒë 120.000ƒë
  - img "iPhone 15 Pro Max"
  - text: "-9% ‚ö° FLASH"
  - button "Th√™m iPhone 15 Pro Max v√†o gi·ªè h√†ng":
    - img
  - heading "iPhone 15 Pro Max" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (156) 29.990.000ƒë 32.990.000ƒë
  - img "M√°y Pha C√† Ph√™ Espresso"
  - button "Th√™m M√°y Pha C√† Ph√™ Espresso v√†o gi·ªè h√†ng":
    - img
  - heading "M√°y Pha C√† Ph√™ Espresso" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (45) 3.990.000ƒë
  - img "B√∫t Bi Cao C·∫•p Parker"
  - button "Th√™m B√∫t Bi Cao C·∫•p Parker v√†o gi·ªè h√†ng":
    - img
  - heading "B√∫t Bi Cao C·∫•p Parker" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (34) 450.000ƒë
  - img "N·ªìi C∆°m ƒêi·ªán Cao C·∫•p"
  - text: "-17% ‚ö° FLASH"
  - button "Th√™m N·ªìi C∆°m ƒêi·ªán Cao C·∫•p v√†o gi·ªè h√†ng":
    - img
  - heading "N·ªìi C∆°m ƒêi·ªán Cao C·∫•p" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (67) 2.490.000ƒë 2.990.000ƒë
  - img "Tai Nghe Bluetooth Premium"
  - text: "-20% ‚ö° FLASH"
  - button "Th√™m Tai Nghe Bluetooth Premium v√†o gi·ªè h√†ng":
    - img
  - heading "Tai Nghe Bluetooth Premium" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (123) 1.990.000ƒë 2.490.000ƒë
  - img "Gi√†y Sneaker Unisex"
  - text: "-25%"
  - button "Th√™m Gi√†y Sneaker Unisex v√†o gi·ªè h√†ng":
    - img
  - heading "Gi√†y Sneaker Unisex" [level=3]
  - text: ‚≠ê ‚≠ê ‚≠ê ‚≠ê ‚≠ê (178) 899.000ƒë 1.199.000ƒë
- contentinfo:
  - text: üõçÔ∏è Yapee
  - paragraph: Yapee cung c·∫•p c√°c s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng cao v·ªõi gi√° c·∫£ ph·∫£i chƒÉng. Ch√∫ng t√¥i cam k·∫øt mang ƒë·∫øn tr·∫£i nghi·ªám mua s·∫Øm t·ªët nh·∫•t cho kh√°ch h√†ng.
  - link "üìò":
    - /url: "#"
  - link "üì∑":
    - /url: "#"
  - link "üê¶":
    - /url: "#"
  - heading "ChƒÉm s√≥c kh√°ch h√†ng" [level=3]
  - list:
    - listitem:
      - link "Trung t√¢m tr·ª£ gi√∫p":
        - /url: "#"
    - listitem:
      - link "Li√™n h·ªá":
        - /url: "#"
    - listitem:
      - link "H∆∞·ªõng d·∫´n mua h√†ng":
        - /url: "#"
    - listitem:
      - link "Ch√≠nh s√°ch ƒë·ªïi tr·∫£":
        - /url: "#"
  - heading "V·ªÅ Yapee" [level=3]
  - list:
    - listitem:
      - link "Gi·ªõi thi·ªáu":
        - /url: "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')"
    - listitem:
      - link "Ch√≠nh s√°ch b·∫£o m·∫≠t":
        - /url: "#"
    - listitem:
      - link "ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng":
        - /url: "#"
    - listitem:
      - link "C√¢u h·ªèi th∆∞·ªùng g·∫∑p":
        - /url: "javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')"
  - heading "Th√¥ng tin li√™n h·ªá" [level=3]
  - list:
    - listitem: üìç 74 ƒë∆∞·ªùng s·ªë 13, Ph∆∞·ªùng B√¨nh Tr·ªã ƒê√¥ng B, qu·∫≠n B√¨nh T√¢n, TP. H·ªì Ch√≠ Minh
    - listitem: üìû 0333.938.014
    - listitem: ‚úâÔ∏è cskh@yapee.vn
    - listitem: üïí 8h00 - 19h00, Th·ª© Hai - Ch·ªß Nh·∫≠t
  - paragraph: ¬© 2024 Yapee. T·∫•t c·∫£ quy·ªÅn ƒë∆∞·ª£c b·∫£o l∆∞u.
```

# Test source

```ts
   1 | import { test, expect, Page } from '@playwright/test';
   2 | import { performance } from 'perf_hooks';
   3 |
   4 | // Performance Test Suite for Week 3
   5 | test.describe('Performance Testing', () => {
   6 |   let startTime: number;
   7 |   let endTime: number;
   8 |
   9 |   test.beforeEach(async ({ page }) => {
   10 |     // Setup performance monitoring
   11 |     startTime = performance.now();
   12 |   });
   13 |
   14 |   test.afterEach(async ({ page }) => {
   15 |     endTime = performance.now();
   16 |     const loadTime = endTime - startTime;
   17 |     console.log(`Test execution time: ${loadTime.toFixed(2)}ms`);
   18 |   });
   19 |
   20 |   test('Homepage load performance', async ({ page }) => {
   21 |     const startLoad = performance.now();
   22 |     
   23 |     // Navigate to homepage
   24 |     await page.goto('http://localhost:5173');
   25 |     
   26 |     // Wait for main content to load
   27 |     await page.waitForSelector('[data-testid="product-grid"]', { timeout: 10000 });
   28 |     
   29 |     const endLoad = performance.now();
   30 |     const loadTime = endLoad - startLoad;
   31 |     
   32 |     console.log(`Homepage load time: ${loadTime.toFixed(2)}ms`);
   33 |     
   34 |     // Performance assertion - should load within 3 seconds
   35 |     expect(loadTime).toBeLessThan(3000);
   36 |     
   37 |     // Take screenshot for documentation
   38 |     await page.screenshot({ 
   39 |       path: `docs/performance-homepage-${Date.now()}.png`,
   40 |       fullPage: true 
   41 |     });
   42 |   });
   43 |
   44 |   test('Product search performance', async ({ page }) => {
   45 |     await page.goto('http://localhost:5173');
   46 |     
   47 |     // Wait for page to load
   48 |     await page.waitForSelector('input[placeholder*="T√¨m ki·∫øm"]');
   49 |     
   50 |     const searchStart = performance.now();
   51 |     
   52 |     // Perform search
   53 |     await page.fill('input[placeholder*="T√¨m ki·∫øm"]', 'laptop');
   54 |     await page.press('input[placeholder*="T√¨m ki·∫øm"]', 'Enter');
   55 |     
   56 |     // Wait for search results
   57 |     await page.waitForSelector('[data-testid="product-grid"]', { timeout: 5000 });
   58 |     
   59 |     const searchEnd = performance.now();
   60 |     const searchTime = searchEnd - searchStart;
   61 |     
   62 |     console.log(`Search response time: ${searchTime.toFixed(2)}ms`);
   63 |     
   64 |     // Search should complete within 2 seconds
   65 |     expect(searchTime).toBeLessThan(2000);
   66 |   });
   67 |
   68 |   test('Cart operations performance', async ({ page }) => {
   69 |     await page.goto('http://localhost:5173');
   70 |     
   71 |     // Wait for products to load
>  72 |     await page.waitForSelector('[data-testid="product-card"]');
      |                ^ Error: page.waitForSelector: Test timeout of 30000ms exceeded.
   73 |     
   74 |     const addToCartStart = performance.now();
   75 |     
   76 |     // Add product to cart
   77 |     const firstProduct = page.locator('[data-testid="product-card"]').first();
   78 |     await firstProduct.locator('button:has-text("Th√™m v√†o gi·ªè")').click();
   79 |     
   80 |     // Wait for cart update
   81 |     await page.waitForSelector('[data-testid="cart-count"]', { timeout: 3000 });
   82 |     
   83 |     const addToCartEnd = performance.now();
   84 |     const addToCartTime = addToCartEnd - addToCartStart;
   85 |     
   86 |     console.log(`Add to cart time: ${addToCartTime.toFixed(2)}ms`);
   87 |     
   88 |     // Cart operations should be fast
   89 |     expect(addToCartTime).toBeLessThan(1000);
   90 |   });
   91 |
   92 |   test('Admin panel load performance', async ({ page }) => {
   93 |     // Login as admin first
   94 |     await page.goto('http://localhost:5173');
   95 |     
   96 |     // Click login
   97 |     await page.click('button:has-text("ƒêƒÉng nh·∫≠p")');
   98 |     
   99 |     // Fill admin credentials
  100 |     await page.fill('input[placeholder="Email"]', 'admin@shopvn.com');
  101 |     await page.fill('input[placeholder="M·∫≠t kh·∫©u"]', 'admin123');
  102 |     await page.click('button[type="submit"]:has-text("ƒêƒÉng nh·∫≠p")');
  103 |     
  104 |     // Wait for login to complete
  105 |     await page.waitForTimeout(2000);
  106 |     
  107 |     const adminLoadStart = performance.now();
  108 |     
  109 |     // Navigate to admin panel
  110 |     await page.click('button:has-text("Admin")');
  111 |     
  112 |     // Wait for admin panel to load
  113 |     await page.waitForSelector('h1:has-text("Admin Dashboard")', { timeout: 10000 });
  114 |     
  115 |     const adminLoadEnd = performance.now();
  116 |     const adminLoadTime = adminLoadEnd - adminLoadStart;
  117 |     
  118 |     console.log(`Admin panel load time: ${adminLoadTime.toFixed(2)}ms`);
  119 |     
  120 |     // Admin panel should load within 5 seconds
  121 |     expect(adminLoadTime).toBeLessThan(5000);
  122 |     
  123 |     // Take screenshot
  124 |     await page.screenshot({ 
  125 |       path: `docs/performance-admin-${Date.now()}.png`,
  126 |       fullPage: true 
  127 |     });
  128 |   });
  129 |
  130 |   test('Memory usage monitoring', async ({ page }) => {
  131 |     await page.goto('http://localhost:5173');
  132 |     
  133 |     // Get initial memory usage
  134 |     const initialMemory = await page.evaluate(() => {
  135 |       return (performance as any).memory ? {
  136 |         usedJSHeapSize: (performance as any).memory.usedJSHeapSize,
  137 |         totalJSHeapSize: (performance as any).memory.totalJSHeapSize,
  138 |         jsHeapSizeLimit: (performance as any).memory.jsHeapSizeLimit
  139 |       } : null;
  140 |     });
  141 |     
  142 |     if (initialMemory) {
  143 |       console.log('Initial memory usage:', initialMemory);
  144 |     }
  145 |     
  146 |     // Perform various operations
  147 |     await page.waitForSelector('[data-testid="product-grid"]');
  148 |     
  149 |     // Navigate through different pages
  150 |     await page.click('a:has-text("Danh m·ª•c")');
  151 |     await page.waitForTimeout(1000);
  152 |     
  153 |     await page.click('a:has-text("Trang ch·ªß")');
  154 |     await page.waitForTimeout(1000);
  155 |     
  156 |     // Get final memory usage
  157 |     const finalMemory = await page.evaluate(() => {
  158 |       return (performance as any).memory ? {
  159 |         usedJSHeapSize: (performance as any).memory.usedJSHeapSize,
  160 |         totalJSHeapSize: (performance as any).memory.totalJSHeapSize,
  161 |         jsHeapSizeLimit: (performance as any).memory.jsHeapSizeLimit
  162 |       } : null;
  163 |     });
  164 |     
  165 |     if (finalMemory && initialMemory) {
  166 |       const memoryIncrease = finalMemory.usedJSHeapSize - initialMemory.usedJSHeapSize;
  167 |       console.log('Memory increase:', memoryIncrease, 'bytes');
  168 |       console.log('Final memory usage:', finalMemory);
  169 |       
  170 |       // Memory increase should be reasonable (less than 50MB)
  171 |       expect(memoryIncrease).toBeLessThan(50 * 1024 * 1024);
  172 |     }
```